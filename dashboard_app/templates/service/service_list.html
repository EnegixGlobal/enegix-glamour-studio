{% extends "base2.html" %}
{% load static %}
{% block content %}

<div class="ribbon-header d-flex justify-content-between align-items-center px-4 pb-5 mb-3" style="color: black">
  <div class="d-flex align-items-center">
    <i class="fas fa-concierge-bell me-3 fs-2" style="color: #ff4f6e;"></i>
    <div class="fw-bold fs-3">Services Management</div>
  </div>
  <div class="breadcrumb-text text-end">
    <span class="text-black"><i class="fas fa-home me-1"></i>HOME</span>
    <span class="mx-2 text-black">/</span>
    <span class="text-black-50">Services</span>
  </div>
</div>

<div class="container-fluid mt-2">
  <!-- Filter Card -->
  <div class="card shadow-lg mb-4 modern-card">
    <div class="card-header table-title-bar fw-bold text-white">
      <i class="fas fa-filter me-2"></i>Filters & Search
    </div>
    <div class="card-body p-4">
      <form method="GET" class="row g-3">
        <div class="col-md-4">
          <label class="form-label"><i class="fas fa-list me-2 text-primary"></i>Category</label>
          <select name="category" class="form-control modern-input">
            <option value="">All Categories</option>
            {% for value, label in categories %}
            <option value="{{ value }}" {% if selected_category == value %}selected{% endif %}>
              {{ label }}
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-search me-2 text-primary"></i>Search</label>
          <input type="text" name="search" class="form-control modern-input" placeholder="Service name or ID..." value="{{ search_query }}">
        </div>
        <div class="col-md-2">
          <label class="form-label d-block">&nbsp;</label>
          <button type="submit" class="btn btn-primary w-100 btn-action">
            <i class="fas fa-search me-2"></i>Filter
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Service Button -->
  <div class="mb-3 text-end">
    <a href="{% url 'add_service' %}" class="btn btn-success btn-action-lg">
      <i class="fas fa-plus-circle me-2"></i>Add New Service
    </a>
  </div>

  <!-- Services Table -->
  <div class="card shadow-lg mb-4 modern-card">
    <div class="card-header table-title-bar fw-bold text-white">
      <i class="fas fa-list-ul me-2"></i>All Services
    </div>
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0 modern-table">
          <thead class="table-header">
            <tr>
              <th>Service ID</th>
              <th>Service Name</th>
              <th>Category</th>
              <th>Duration</th>
              <th>Base Price</th>
              <th>Employees</th>
              <th>Website</th>
              <th>Status</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for service in services %}
            <tr>
              <td><span class="badge bg-secondary">{{ service.service_id }}</span></td>
              <td>
                <div class="d-flex align-items-center">
                  {% if service.service_image %}
                  <img src="{{ service.service_image.url }}" alt="{{ service.service_name }}" 
                       style="width: 45px; height: 45px; object-fit: cover; border-radius: 8px; margin-right: 10px;" />
                  {% else %}
                  <div style="width: 45px; height: 45px; background: linear-gradient(135deg, #ff4f6e 0%, #ff80ab 100%); border-radius: 8px; margin-right: 10px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-spa text-white"></i>
                  </div>
                  {% endif %}
                  <strong>{{ service.service_name }}</strong>
                </div>
              </td>
              <td><span class="badge-category">{{ service.get_category_display }}</span></td>
              <td><i class="fas fa-clock text-primary me-1"></i>{{ service.duration_minutes }} min</td>
              <td><strong class="text-success">â‚¹{{ service.base_price }}</strong></td>
              <td>
                <a href="{% url 'manage_service_employees' service.id %}" class="btn btn-sm btn-outline-primary btn-modern">
                  <i class="fas fa-users me-1"></i>{{ service.service_employees.count }} Assigned
                </a>
              </td>
              <td>
                {% if service.display_on_website %}
                <span class="badge-status-active">Visible</span>
                {% else %}
                <span class="badge-status-inactive">Hidden</span>
                {% endif %}
              </td>
              <td>
                {% if service.is_active %}
                <span class="badge-status-active">Active</span>
                {% else %}
                <span class="badge-status-inactive">Inactive</span>
                {% endif %}
              </td>
              <td>
                <div class="btn-group-modern" role="group">
                  <a href="{% url 'edit_service' service.id %}" class="btn-action-modern btn-warning" title="Edit">
                    <i class="fas fa-edit"></i>
                  </a>
                  <a href="{% url 'assign_service_to_employee' service.id %}" class="btn-action-modern btn-info" title="Assign Employees">
                    <i class="fas fa-user-plus"></i>
                  </a>
                  <a href="{% url 'toggle_service_display' service.id %}" class="btn-action-modern btn-secondary" title="Toggle Website Display">
                    <i class="fas fa-eye"></i>
                  </a>
                  <a href="{% url 'toggle_service_active' service.id %}" class="btn-action-modern btn-primary" title="Toggle Active Status">
                    <i class="fas fa-power-off"></i>
                  </a>
                  <a href="{% url 'delete_service' service.id %}" class="btn-action-modern btn-danger" 
                     onclick="return confirm('Are you sure you want to delete this service?')" title="Delete">
                    <i class="fas fa-trash"></i>
                  </a>
                </div>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="9" class="text-center text-muted py-5">
                <i class="fas fa-inbox fa-3x mb-3 d-block" style="opacity: 0.3;"></i>
                <h5>No services found</h5>
                <p>Try adjusting your filters or add a new service.</p>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- Pagination -->
    {% if services.has_other_pages %}
    <div class="card-footer bg-light">
      <nav>
        <ul class="pagination justify-content-center mb-0">
          {% if services.has_previous %}
          <li class="page-item">
            <a class="page-link modern-page-link" href="?page={{ services.previous_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}{% if search_query %}&search={{ search_query }}{% endif %}">
              <i class="fas fa-chevron-left"></i> Previous
            </a>
          </li>
          {% endif %}
          
          <li class="page-item active">
            <span class="page-link modern-page-link">
              Page {{ services.number }} of {{ services.paginator.num_pages }}
            </span>
          </li>
          
          {% if services.has_next %}
          <li class="page-item">
            <a class="page-link modern-page-link" href="?page={{ services.next_page_number }}{% if selected_category %}&category={{ selected_category }}{% endif %}{% if search_query %}&search={{ search_query }}{% endif %}">
              Next <i class="fas fa-chevron-right"></i>
            </a>
          </li>
          {% endif %}
        </ul>
      </nav>
    </div>
    {% endif %}
  </div>
</div>

<style>
.modern-card {
  border-radius: 15px;
  border: none;
  overflow: hidden;
}

.modern-input {
  border: 2px solid #e0e0e0 !important;
  border-radius: 10px;
  padding: 12px 15px;
  transition: all 0.3s ease;
  color: #000;
}

.modern-input:focus {
  border-color: #ff4f6e !important;
  background-color: #fff5f7 !important;
  box-shadow: 0 0 0 0.2rem rgba(255, 79, 110, 0.15);
}

.form-label {
  font-weight: 600;
  color: #333;
  margin-bottom: 8px;
}

.card-header.table-title-bar {
  background: linear-gradient(135deg, #ff4f6e 0%, #ff80ab 100%);
  padding: 20px;
  font-size: 18px;
  border-bottom: 3px solid rgba(255,255,255,0.2);
}

.modern-table {
  font-size: 14px;
}

.modern-table thead.table-header {
  background: linear-gradient(135deg, #fff5f7 0%, #ffe9ed 100%);
  color: #333;
  font-weight: 600;
}

.modern-table thead th {
  border-bottom: 2px solid #ff4f6e;
  padding: 15px;
  vertical-align: middle;
}

.modern-table tbody td {
  padding: 15px;
  vertical-align: middle;
  border-bottom: 1px solid #f0f0f0;
}

.modern-table tbody tr:hover {
  background-color: #fff5f7;
  transition: all 0.3s ease;
}

.badge-category {
  display: inline-block;
  padding: 6px 12px;
  border-radius: 8px;
  background: linear-gradient(135deg, #69ffe4 0%, #5ce1e6 100%);
  color: #000;
  font-weight: 600;
  font-size: 12px;
}

.badge-status-active {
  display: inline-block;
  padding: 6px 12px;
  border-radius: 8px;
  background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
  color: white;
  font-weight: 600;
  font-size: 12px;
}

.badge-status-inactive {
  display: inline-block;
  padding: 6px 12px;
  border-radius: 8px;
  background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
  color: white;
  font-weight: 600;
  font-size: 12px;
}

.btn-modern {
  border-radius: 8px;
  padding: 6px 12px;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-modern:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}

.btn-group-modern {
  display: flex;
  gap: 5px;
  justify-content: center;
}

.btn-action-modern {
  width: 35px;
  height: 35px;
  border-radius: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  border: none;
  color: white;
  font-size: 14px;
}

.btn-action-modern:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  color: white;
}

.btn-action-modern.btn-warning {
  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
}

.btn-action-modern.btn-info {
  background: linear-gradient(135deg, #69ffe4 0%, #5ce1e6 100%);
}

.btn-action-modern.btn-secondary {
  background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
}

.btn-action-modern.btn-primary {
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
}

.btn-action-modern.btn-danger {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

.btn-action {
  padding: 10px 20px;
  border-radius: 10px;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-action:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.btn-action-lg {
  padding: 12px 30px;
  border-radius: 10px;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-action-lg:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.btn-primary {
  background: linear-gradient(135deg, #ff4f6e 0%, #ff80ab 100%);
  border: none;
}

.btn-primary:hover {
  background: linear-gradient(135deg, #e63956 0%, #ff6b9d 100%);
}

.btn-success {
  background: linear-gradient(135deg, #ff80ab 0%, #ffa4c4 100%);
  border: none;
}

.btn-success:hover {
  background: linear-gradient(135deg, #ff6b9d 0%, #ff8fb5 100%);
}

.ribbon-header {
  background: linear-gradient(135deg, #fff5f7 0%, #ffe9ed 100%);
  border-radius: 15px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 2px 10px rgba(255, 79, 110, 0.05);
}

.text-primary {
  color: #ff4f6e !important;
}

.modern-page-link {
  border-radius: 8px;
  margin: 0 5px;
  padding: 8px 16px;
  border: 2px solid #ff4f6e;
  color: #ff4f6e;
  font-weight: 600;
  transition: all 0.3s ease;
}

.modern-page-link:hover {
  background: linear-gradient(135deg, #ff4f6e 0%, #ff80ab 100%);
  color: white;
  transform: translateY(-2px);
}

.page-item.active .modern-page-link {
  background: linear-gradient(135deg, #ff4f6e 0%, #ff80ab 100%);
  border-color: #ff4f6e;
  color: white;
}
</style>

{% endblock %}